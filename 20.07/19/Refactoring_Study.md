## 2020.07.19 Refactoring 스터디

- 로드 밸런서 종류

- IP Hashing이 필요할 때.

로드 밸런서를 활용할 때, 만약 유저를 인증해야하는 경우는 어떡할까? 세션을 서버에 저장하고 있는 형태의 프로그램이고 3개의 서버를 돌리고 있다고 가정해보자. 만약 첫 유저가 server a에 세션을 저장하고 다음 요청을 보내는데 로드밸런서가 이 요청을 세션이 저장되어 있지 않은 server b 또는 c로 보냈다면 사용자의 로그인이 풀리는 사태가 발생할 것이다. 이런경우를 방지하려는 것이 IP Hashing이다. 로드밸런서에 예를 들어, 이 아이피는 이 서버로 간다라고 로드밸런서에 Hashing을 해놓으면 해당 IP로 접속한 경우 a, b, c 셋중 하나의 서버로 접속을 하게된다. 이것이 바로 IP Hashing이다. 그런데 이방법은 서버가 작을 때 해결하는 방법이다. 서버가 클 때 이 문제를 해결하는 방법은 redis를 활용하는 것이다. 우선 로드밸런서가 우선적으로 아무 서버에 접근한다. 그리고 세션정보를 redis에 저장한다. 접근된 서버는 redis로 가고 세션을 검색한다. 이런 방식으로 로그인을 유지하는 것이다.